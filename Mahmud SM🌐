import telebot
from telebot import types
import os

TOKEN = os.getenv("8341661339:AAESZOHh_IOlnYiYU0xJsJq5LyHG3g8WcBI")

bot = telebot.TeleBot(TOKEN)

# ===== CONFIG =====
ADMIN_ID = 66749223  # <-- SA ID DINKA ANAN

users = set()

# ===== START =====
@bot.message_handler(commands=['start'])
def start(message):
    users.add(message.chat.id)

    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)

    btn1 = types.KeyboardButton("ðŸŒ Facebook")
    btn2 = types.KeyboardButton("ðŸ“¢ Telegram Channel")
    btn3 = types.KeyboardButton("ðŸ¦ X (Twitter)")
    btn4 = types.KeyboardButton("â„¹ï¸ About Me")
    btn5 = types.KeyboardButton("ðŸ’» Programmers")

    markup.add(btn1, btn2)
    markup.add(btn3, btn4)
    markup.add(btn5)

    bot.send_message(
        message.chat.id,
        "ðŸ‘‹ Welcome to Mahmud's Bot!\n\nSelect an option from the menu below ðŸ‘‡",
        reply_markup=markup
    )

# ===== BUTTON HANDLER =====
@bot.message_handler(func=lambda message: True)
def handle_buttons(message):
    users.add(message.chat.id)

    text = message.text

    if text == "ðŸŒ Facebook":
        bot.send_message(message.chat.id, "ðŸ‘‰ Facebook Page:\nhttps://www.facebook.com/share/1GWma4DRsg/")

    elif text == "ðŸ“¢ Telegram Channel":
        bot.send_message(message.chat.id, "ðŸ‘‰ Telegram Channel:\nhttps://t.me/Mahmudsm1")

    elif text == "ðŸ¦ X (Twitter)":
        bot.send_message(message.chat.id, "ðŸ‘‰ X (Twitter):\nhttps://x.com/Mahmud_sm1")

    elif text == "â„¹ï¸ About Me":
        about_text = """
ðŸ‘¤ About Me:

ðŸ‡¬ðŸ‡§ English:
My name is Mahmud. I am a learner and a tech enthusiast. I love programming and technology.

ðŸ‡³ðŸ‡¬ Hausa:
Sunana Mahmud. Ina koyon fasahar computer da programming. Ina son ilimi da cigaba.

ðŸ“© You can message me directly on Telegram:
ðŸ‘‰ @MHSM5
"""
        bot.send_message(message.chat.id, about_text)

    elif text == "ðŸ’» Programmers":
        prog_text = """
ðŸ’» About Programming:

Programming is the skill of telling a computer what to do.

It helps you to:
âœ… Build apps
âœ… Build websites
âœ… Create games
âœ… Solve problems
âœ… Work with technology

Learning programming is one of the best skills in this modern world ðŸŒ.
"""
        bot.send_message(message.chat.id, prog_text)

    # ===== ADMIN COMMANDS =====
    elif text.startswith("/broadcast"):
        if message.from_user.id == ADMIN_ID:
            msg = text.replace("/broadcast", "").strip()

            if not msg:
                bot.send_message(message.chat.id, "â— Usage:\n/broadcast Your message here")
                return

            count = 0
            for user_id in users:
                try:
                    bot.send_message(user_id, "ðŸ“¢ Broadcast:\n\n" + msg)
                    count += 1
                except:
                    pass

            bot.send_message(message.chat.id, f"âœ… Message sent to {count} users.")

        else:
            bot.send_message(message.chat.id, "â›” You are not admin!")

    elif text == "/stats":
        if message.from_user.id == ADMIN_ID:
            bot.send_message(message.chat.id, f"ðŸ‘¥ Total users: {len(users)}")
        else:
            bot.send_message(message.chat.id, "â›” You are not admin!")

    else:
        bot.send_message(message.chat.id, "â— Please use the menu buttons or type /start")

# ===== RUN =====
print("ðŸ¤– Bot is running...")
bot.infinity_polling()
